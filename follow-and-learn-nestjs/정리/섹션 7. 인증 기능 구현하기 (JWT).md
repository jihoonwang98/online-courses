# 섹션 7. 인증 기능 구현하기 (JWT)

> 사이트: [따라하며 배우는 NestJS](https://inf.run/n39u)
>
> [소스 코드 저장소](https://github.com/jaewonhimnae/nestjs-board-app)



### 목차

- 인증 기능 구현을 위한 준비
- 회원가입 기능 구현
- 유저 데이터 유효성 체크
- 유저 이름에 유니크한 값 주기
- 비밀번호 암호화 하기 (설명)
- 비밀번호 암호화 하기 (소스 코드 구현)
- 로그인 기능 구현하기
- JWT에 대해서
- JWT를 이용해서 토큰 생성하기
- Passport, JWT 이용해서 토큰 인증 후 유저 정보 가져오기
- 커스텀 데코레이터 생성하기
- 인증된 유저만 게시물 보고 쓸 수 있게 해주기



## \#1. 인증 기능 구현을 위한 준비

![image-20211024150107873](/Users/mojo/Library/Application Support/typora-user-images/image-20211024150107873.png)

![image-20211024150315660](/Users/mojo/Library/Application Support/typora-user-images/image-20211024150315660.png)

![image-20211024150336569](/Users/mojo/Library/Application Support/typora-user-images/image-20211024150336569.png)

![image-20211024150347335](/Users/mojo/Library/Application Support/typora-user-images/image-20211024150347335.png)

![image-20211024150356187](/Users/mojo/Library/Application Support/typora-user-images/image-20211024150356187.png)



## \#2. 회원 가입 기능 구현

![image-20211024151103595](/Users/mojo/Library/Application Support/typora-user-images/image-20211024151103595.png)

![image-20211024151113152](/Users/mojo/Library/Application Support/typora-user-images/image-20211024151113152.png)





## \#3. 유저 데이터 유효성 체크

![image-20211024152325766](/Users/mojo/Library/Application Support/typora-user-images/image-20211024152325766.png)

![image-20211024152343168](/Users/mojo/Library/Application Support/typora-user-images/image-20211024152343168.png)

![image-20211024152352823](/Users/mojo/Library/Application Support/typora-user-images/image-20211024152352823.png)

![image-20211024152402767](/Users/mojo/Library/Application Support/typora-user-images/image-20211024152402767.png)



## \#4. 유저 이름에 유니크한 값 주기

![image-20211024152851998](/Users/mojo/Library/Application Support/typora-user-images/image-20211024152851998.png)

![image-20211024152904241](/Users/mojo/Library/Application Support/typora-user-images/image-20211024152904241.png)

![image-20211024152934294](/Users/mojo/Library/Application Support/typora-user-images/image-20211024152934294.png)

![image-20211024152957672](/Users/mojo/Library/Application Support/typora-user-images/image-20211024152957672.png)





## \#5. 비밀번호 암호화 하기(이론)

![image-20211024153336152](/Users/mojo/Library/Application Support/typora-user-images/image-20211024153336152.png)

```
$ npm install bcryptjs --save
import * as bcrypt from 'bcryptjs';
```



![image-20211024155130771](/Users/mojo/Library/Application Support/typora-user-images/image-20211024155130771.png)



![image-20211024155154459](/Users/mojo/Library/Application Support/typora-user-images/image-20211024155154459.png)

- 밑에 좀 짤림, 4번은 원래 없는 거임
- A 유저 비밀번호 1234 ===> kenfuduWssW_1234 ===> kfowekpfkweosodck
- B 유저 비밀번호 1234 ===> okdowmnxikjd_1234 ===> kodklmxjjxhdndnwjdj
- A 유저와 B 유저의 salt를 다르게 설정해서 같은 비밀번호를 써도 해시값이 다르게 만들 수 있다.



![image-20211024155204377](/Users/mojo/Library/Application Support/typora-user-images/image-20211024155204377.png)





## \#6. 비밀번호 암호화 하기(소스코드구현)

![image-20211024160404919](/Users/mojo/Library/Application Support/typora-user-images/image-20211024160404919.png)





## \#7. 로그인 기능 구현하기

![image-20211024160838050](/Users/mojo/Library/Application Support/typora-user-images/image-20211024160838050.png)





## \#8. JWT에 대하여

![image-20211024161713036](/Users/mojo/Library/Application Support/typora-user-images/image-20211024161713036.png)

![image-20211024161724833](/Users/mojo/Library/Application Support/typora-user-images/image-20211024161724833.png)

![image-20211024161742427](/Users/mojo/Library/Application Support/typora-user-images/image-20211024161742427.png)

![image-20211024161756131](/Users/mojo/Library/Application Support/typora-user-images/image-20211024161756131.png)

![image-20211024161805527](/Users/mojo/Library/Application Support/typora-user-images/image-20211024161805527.png)





## \#9. JWT를 이용해서 토큰 생성하기

![image-20211024163330649](/Users/mojo/Library/Application Support/typora-user-images/image-20211024163330649.png)

![image-20211024163342665](/Users/mojo/Library/Application Support/typora-user-images/image-20211024163342665.png)

![image-20211024163355316](/Users/mojo/Library/Application Support/typora-user-images/image-20211024163355316.png)

![image-20211024163407390](/Users/mojo/Library/Application Support/typora-user-images/image-20211024163407390.png)





## \#10. Passport, JWT 이용해서 토큰 인증 후 유저 정보 가져오기

![image-20211024170421322](/Users/mojo/Library/Application Support/typora-user-images/image-20211024170421322.png)

![image-20211024170535135](/Users/mojo/Library/Application Support/typora-user-images/image-20211024170535135.png)

![image-20211024170600465](/Users/mojo/Library/Application Support/typora-user-images/image-20211024170600465.png)

![image-20211024170734135](/Users/mojo/Library/Application Support/typora-user-images/image-20211024170734135.png)

![image-20211024170742797](/Users/mojo/Library/Application Support/typora-user-images/image-20211024170742797.png)

![image-20211024170752490](/Users/mojo/Library/Application Support/typora-user-images/image-20211024170752490.png)















